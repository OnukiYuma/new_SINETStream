
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://onukiyuma.github.io/SINETStream/tutorial-android/sinetstreamhelper-tutorial-container/TUTORIAL-docker-container/">
      
      
        <link rel="prev" href="../../TUTORIAL-android-keychain/">
      
      
        <link rel="next" href="../../../userguide/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>DOCKER-CONTAINER - SINETStream</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../styles/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#-docker-container" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../../.." title="SINETStream" class="md-header__button md-logo" aria-label="SINETStream" data-md-component="logo">
      
  <img src="../../../images/SiNETStream.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SINETStream
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DOCKER-CONTAINER
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="言語切り替え">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="ja" class="md-select__link">
              日本語
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../en/tutorial-android/sinetstreamhelper-tutorial-container/TUTORIAL-docker-container/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../docm/" class="md-tabs__link">
          
  
  SINETStreamについて

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../tutorial/" class="md-tabs__link">
          
  
  チュートリアル

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../userguide/" class="md-tabs__link">
          
  
  ユーザガイド

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../developer_guide/" class="md-tabs__link">
          
  
  プラグイン開発ガイド

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="SINETStream" class="md-nav__button md-logo" aria-label="SINETStream" data-md-component="logo">
      
  <img src="../../../images/SiNETStream.png" alt="logo">

    </a>
    SINETStream
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SINETStreamについて
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            SINETStreamについて
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../docm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ドキュメント
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../performance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SINETStream性能測定結果
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../livedemo/livedemo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SINETStreamのライブデモ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SINETStreamサーバ構築手順
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            SINETStreamサーバ構築手順
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../server/brokers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    サーバ構築手順
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../server/brokers/%E3%83%97%E3%83%A9%E3%82%A4%E3%83%99%E3%83%BC%E3%83%88%E8%AA%8D%E8%A8%BC%E5%B1%80%E3%81%A7%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%82%92%E4%BD%9C%E6%88%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    プライベート認証局で証明書を作成する
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../server/brokers/Kafkabroker%E3%81%AE%E6%A7%8B%E7%AF%89%E6%89%8B%E9%A0%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kafka brokerの構築手順
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../server/brokers/mosquitto%E6%A7%8B%E7%AF%89%E6%89%8B%E9%A0%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mosquitto(MQTT broker)の構築手順
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    更新履歴
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    チュートリアル
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            チュートリアル
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python/Java版
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Python/Java版
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    クイックスタートガイド
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/TUTORIAL-STEP1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    STEP1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/TUTORIAL-STEP2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    STEP2
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Android版
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Android版
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    クイックスタートガイド
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    sinetstream-android-echo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            sinetstream-android-echo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TUTORIAL-android-step1-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    テキスト送受信アプリの実行
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TUTORIAL-android-step1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ANDROID-STEP1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    sinetstream-android-sensor-publisher
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            sinetstream-android-sensor-publisher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TUTORIAL-android-step2-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    センサ情報収集アプリの実行
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TUTORIAL-android-step2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ANDROID-STEP2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TUTORIAL-android-step2-webbrowser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    センサーデータ可視化用のウェブインタフェース
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TUTORIAL-android-step2-location/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    端末位置情報の自動更新
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SINETStream Android Tutorial Container
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TUTORIAL-android-install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Androidサンプルアプリケーションの導入
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TUTORIAL-android-keychain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    システム秘匿領域への証明書ファイルの導入
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    DOCKER-CONTAINER
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    DOCKER-CONTAINER
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 概要
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 動作基盤の整備
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 動作基盤の整備">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-amazon-awsec2" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Amazon AWSのEC2をホスト機材とする場合
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.1 Amazon AWSのEC2をホスト機材とする場合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211-ec2" class="md-nav__link">
    <span class="md-ellipsis">
      2.1.1 EC2インスタンスの作成と起動
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ec2" class="md-nav__link">
    <span class="md-ellipsis">
      EC2インスタンスのメモリ不足に注意！
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EC2インスタンスのメモリ不足に注意！">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#212-ec2docker-engine" class="md-nav__link">
    <span class="md-ellipsis">
      2.1.2 EC2インスタンスへのDocker Engineの導入
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 手元機材をホストとする場合
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 手元機材をホストとする場合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.1 手元機材の調達
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-docker-engine" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.2 手元機材へのDocker Engineの導入
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. コンテナイメージの操作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. コンテナイメージの操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-broker" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 brokerコンテナの導入と起動
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-broker" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 brokerコンテナの停止と再起動
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-broker" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 brokerコンテナの削除と再導入
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ユーザガイド
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ユーザガイド
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ユーザガイド
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/api-python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/api-java/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Android版
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Android版
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/android/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SINETStream for Android ユーザガイド
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/api-android/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android版SINETStreamライブラリ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="http://javadoc.android.sinetstream.net/sinetstream-android/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API (Javadoc)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/config-android/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android版のSINETStream設定ファイル
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/config-client-android/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android版の設定クライアント
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SINETStreamHelper
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            SINETStreamHelper
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/libhelper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SINETStreamHelper ユーザガイド
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/api-libhelper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SINETStreamHelperライブラリ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="http://javadoc.android.sinetstream.net/sinetstream-android-helper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API (Javadoc)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    設定ファイル
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    認証と認可
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/nii-gakunin-cloud/sinetstream/blob/main/java/sample/cli/README.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI(Command Line Interface)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/compat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    互換性
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    プラグイン開発ガイド
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            プラグイン開発ガイド
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    開発者ガイド
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Messaging system
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Messaging system
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_guide/plugin_broker_python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_guide/plugin_broker_java/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    message type
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            message type
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_guide/plugin_value_type_python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_guide/plugin_value_type_java/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    compression
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            compression
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_guide/plugin_compression_python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_guide/plugin_compression_java/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_guide/message_format/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    メッセージフォーマット
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 概要
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 動作基盤の整備
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 動作基盤の整備">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-amazon-awsec2" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Amazon AWSのEC2をホスト機材とする場合
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.1 Amazon AWSのEC2をホスト機材とする場合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211-ec2" class="md-nav__link">
    <span class="md-ellipsis">
      2.1.1 EC2インスタンスの作成と起動
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ec2" class="md-nav__link">
    <span class="md-ellipsis">
      EC2インスタンスのメモリ不足に注意！
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EC2インスタンスのメモリ不足に注意！">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#212-ec2docker-engine" class="md-nav__link">
    <span class="md-ellipsis">
      2.1.2 EC2インスタンスへのDocker Engineの導入
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 手元機材をホストとする場合
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 手元機材をホストとする場合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.1 手元機材の調達
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-docker-engine" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.2 手元機材へのDocker Engineの導入
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. コンテナイメージの操作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. コンテナイメージの操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-broker" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 brokerコンテナの導入と起動
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-broker" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 brokerコンテナの停止と再起動
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-broker" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 brokerコンテナの削除と再導入
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<!--
Copyright (C) 2020-2021 National Institute of Informatics

Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

<h1 id="-docker-container">チュートリアル - DOCKER-CONTAINER</h1>
<h2 id="1">1. 概要</h2>
<p>本書では、アプリケーション仮想実行環境である<code>Docker</code>コンテナ上に<code>Broker</code>などバックエンド機能を構築する方法について紹介します。</p>
<h2 id="2">2. 動作基盤の整備</h2>
<p><code>Docker Engine</code>はLinuxやmacOS、Windowsなどさまざまな動作環境に対応しています。
まずは適当な機材にこれを導入するところから始めます。
次に、チュートリアル用に用意したコンテナイメージをインターネット経由でダウンロードし、上記<code>Docker Engine</code>環境で起動するという作業の流れとなります。</p>
<h3 id="21-amazon-awsec2">2.1 Amazon AWSのEC2をホスト機材とする場合</h3>
<p>商用クラウドサービスの一つとして広く使われている仮想サーバ基盤
<a href="https://aws.amazon.com/jp/ec2/?nc1=h_ls">Amazon EC2</a>
（OSに
<a href="https://aws.amazon.com/jp/amazon-linux-2/">Amazon Linux 2</a>
を採用）を利用します。この上に
<a href="https://www.docker.com/resources/what-container">Dockerコンテナ</a>
を導入して<code>Broker</code>などバックエンド機能を載せるという構成です。</p>
<pre><code>    [Android]-----(Celluar)-----(INTERNET)-----[Amazon AWS]
</code></pre>
<p>この場合、Android端末上のクライアントと<code>Amazon AWS</code>の<code>EC2</code>とはインターネット経由で接続します。</p>
<h4 id="211-ec2">2.1.1 EC2インスタンスの作成と起動</h4>
<p>AWSコンソール上の操作により適当なEC2インスタンスを作成して起動すると、グローバルIPアドレスやSSHログイン認証鍵が払い出されます。
当該EC2インスタンスにSSHログインしてください。</p>
<pre><code class="language-console">[localUser@localPC]$ ssh ec2-user@aws-ipaddress

       __|  __|_  )
       _|  (     /   Amazon Linux 2 AMI
      ___|\___|___|

https://aws.amazon.com/amazon-linux-2/
</code></pre>
<blockquote>
<h2 id="ec2">EC2インスタンスのメモリ不足に注意！</h2>
<p>筆者が動作試験をした際、当初はEC2インスタンスタイプとして最小
構成の<code>t2.micro</code>（メモリ2GB）を選択しました。
単純に<code>MQTT</code>ブローカを置いて「受信メッセージを再配信する」には
問題ないのです。しかし「同ブローカからさらに<code>Kafka</code>ブローカを
介してセンサー情報を可視化するバックエンドシステム」を構築しよ
うとして動作不安定（グラフ表示されない）事象が発生しました。
Kafkaブローカがメモリ不足で異常終了し、supervisorがこれを自動
再起動するという状態を繰り返すことが原因でした。
結局、より容量の大きな<code>t3.large</code>（メモリ8GB）でEC2インスタンス
を作り直したことで本事象を解消しました。</p>
</blockquote>
<h4 id="212-ec2docker-engine">2.1.2 EC2インスタンスへの<code>Docker Engine</code>の導入</h4>
<p>Amazon EC2への<code>Docker Engine</code>導入方法に関してはAWSから当該文書
<a href="https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/docker-basics.html">Amazon ECSにおけるDockerの基本</a>
が用意されているので、こちらを適宜参照してください。
文中で<code>Docker イメージの作成</code>の手前までが該当します。</p>
<p>まずはシステムを最新化します。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo yum update
[sudo] password for ec2-user:
Loaded plugins: extras_suggestions, langpacks, priorities, update-motd
amzn2-core                                               | 3.7 kB     00:00
No packages marked for update
</code></pre>
<p>AWSの案内に従い、所用のパッケージを導入します。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo amazon-linux-extras install docker
Installing docker
[...]
Complete!
</code></pre>
<p><code>Docker</code>サービスを開始します。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo service docker start
Redirecting to /bin/systemctl start docker.service
</code></pre>
<p>一旦ログアウトしてください。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ exit
logout
Connection to 172.29.2.12 closed.
Killed by signal 1.
</code></pre>
<p>AWSに再ログインし、導入された<code>Docker</code>情報を確認してみます。</p>
<pre><code class="language-console">[localUser@localPC]$ ssh ec2-user@aws-ipaddress
...
[ec2-user@ip-172-30-2-88 ~]$ sudo docker info
...
</code></pre>
<p><code>Docker Engine</code>導入直後なので、<code>Dockerイメージ</code>は空です。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
</code></pre>
<p>コンテナ上のプロセスもありません。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</code></pre>
<h3 id="22">2.2 手元機材をホストとする場合</h3>
<h4 id="221">2.2.1 手元機材の調達</h4>
<p>お手元の適当なPC機材（macOS/Windows/Linux）が<code>Docker Engine</code>の動作条件を満足し、
かつインターネットに接続可能であるなら、それをホスト機材として活用できます。</p>
<pre><code>    [Android]-----[Wi-Fi_AP]-----(LAN)-----[Local PC]
</code></pre>
<p>この場合、Android端末上のクライアントと当該機材とはLANで接続します。</p>
<h4 id="222-docker-engine">2.2.2 手元機材への<code>Docker Engine</code>の導入</h4>
<p>代表的なプラットフォームにおける<code>Docker Engine</code>導入方法を示します。</p>
<ul>
<li>macOS<ul>
<li><a href="https://docs.docker.com/docker-for-mac/install/">Install Docker Desktop on Mac</a></li>
</ul>
</li>
<li>Microsoft Windows 10<ul>
<li><a href="https://docs.docker.com/docker-for-windows/install/">Install Docker Desktop on Windows</a></li>
</ul>
</li>
<li>CentOS(x86_64)<ul>
<li><a href="https://docs.docker.com/install/linux/docker-ce/centos/">Get Docker Engine - Community for CentOS</a></li>
</ul>
</li>
</ul>
<p>その他のOSについてはDocker公式サイトの
<a href="https://docs.docker.com/install/#supported-platforms">Supported platforms</a>
に記載されているリンク先などを参照してください。</p>
<h2 id="3">3. コンテナイメージの操作</h2>
<h3 id="31-broker">3.1 <code>broker</code>コンテナの導入と起動</h3>
<p>このチュートリアル用のコンテナイメージを用意してあります。</p>
<p>以下のコマンドにより導入してください。
手元になければリポジトリからダウンロードするため数分かかります。
イメージを取得すだけなら<code>docker pull</code>、
コンテナ起動は<code>docker start</code>とそれぞれ単独コマンドがあるのですが、
<code>docker run</code>によりこの2つの操作をまとめて実施することになります。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker run -d --name broker -p 1883:1883 -p 80:80 harbor.vcloud.nii.ac.jp/sinetstream/android-tutorial:latest
Unable to find image 'harbor.vcloud.nii.ac.jp/sinetstream/android-tutorial:latest' locally
latest: Pulling from sinetstream/android-tutorial
[...]
Status: Downloaded newer image for harbor.vcloud.nii.ac.jp/sinetstream/android-tutorial:latest
b1020bcf10fa4d20971db247c12e7a9d3b4803ea0ee4dd11d14ea6bd1bc95c3a
</code></pre>
<blockquote>
<p>上記<code>docker run</code>コマンドの引数で、コンテナ名称を<code>broker</code>、TCPポート
1883(mqtt)と80(http)の2つを開くように指定しています。</p>
<p>サービスの待ち受けポート番号を変更する場合は<code>-p</code>オプションの値を
変更してください。例えばMQTTブローカーのポート番号を<code>11883</code>に
変更する場合は<code>-p 11883:1883</code>と指定してください。
<code>-p</code>引数の詳細については
<a href="https://docs.docker.com/engine/reference/run/#expose-incoming-ports">Docker run reference</a>を参照してください。</p>
</blockquote>
<p>導入した<code>broker</code>コンテナイメージを見てみます。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker images
REPOSITORY                                             TAG                 IMAGE ID            CREATED             SIZE
harbor.vcloud.nii.ac.jp/sinetstream/android-tutorial   latest              1b697be85b10        2 months ago        1.22GB
</code></pre>
<p><code>Docker</code>プロセスを参照して、状態(STATUS)が<code>UP</code>であれば成功です。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker ps -a
CONTAINER ID        IMAGE                                                         COMMAND                  CREATED             STATUS              PORTS                                        NAMES
b1020bcf10fa        harbor.vcloud.nii.ac.jp/sinetstream/android-tutorial:latest   &quot;/usr/local/bin/supe…&quot;   4 minutes ago       Up 4 minutes        0.0.0.0:80-&gt;80/tcp, 0.0.0.0:1883-&gt;1883/tcp   broker
</code></pre>
<p><code>broker</code>コンテナ上で所用のTCPポートを開いていることを確認します。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker exec -t broker ss -an | grep LISTEN
u_str  LISTEN     0      128    /var/run/supervisor/supervisor.sock.1 30266                 * 0
tcp    LISTEN     0      128       *:80                    *:*    &lt;--(!)
tcp    LISTEN     0      50        *:45521                 *:*
tcp    LISTEN     0      50        *:8083                  *:*
tcp    LISTEN     0      100       *:1883                  *:*    &lt;--(!)
tcp    LISTEN     0      50        *:34147                 *:*
tcp    LISTEN     0      50        *:9092                  *:*
tcp    LISTEN     0      50        *:2181                  *:*
tcp    LISTEN     0      50        *:36551                 *:*
tcp    LISTEN     0      100    [::]:1883               [::]:*
tcp    LISTEN     0      128    [::]:9000               [::]:*
</code></pre>
<h3 id="32-broker">3.2 <code>broker</code>コンテナの停止と再起動</h3>
<p>以下のコマンドにより<code>broker</code>コンテナを停止します。
コマンド完了までしばらく時間がかかるかもしれません。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker stop broker
broker
</code></pre>
<p><code>Docker</code>プロセスを参照して、状態(STATUS)が<code>Exited</code>であれば成功です。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker ps -a
CONTAINER ID        IMAGE                                                         COMMAND                  CREATED             STATUS                        PORTS               NAMES
b1020bcf10fa        harbor.vcloud.nii.ac.jp/sinetstream/android-tutorial:latest   &quot;/usr/local/bin/supe…&quot;   10 hours ago        Exited (137) 38 seconds ago                       broker
</code></pre>
<p>また、以下のコマンドにより<code>broker</code>コンテナを再起動できます。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker start broker
broker
</code></pre>
<h3 id="33-broker">3.3 <code>broker</code>コンテナの削除と再導入</h3>
<p>不要になった<code>broker</code>コンテナは、以下のコマンドにより削除してください。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker rm broker
broker
</code></pre>
<p>なお、手元のホスト環境にはコンテナイメージは残ります。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker images
REPOSITORY                                             TAG                 IMAGE ID            CREATED             SIZE
harbor.vcloud.nii.ac.jp/sinetstream/android-tutorial   latest              1b697be85b10        2 months ago        1.22GB
</code></pre>
<p>初期導入時と同じ<code>docker run</code>コマンドを実行しても、
リポジトリからの取得はスキップされ、そのまま<code>broker</code>コンテナが再起動されます。</p>
<pre><code class="language-console">[ec2-user@ip-172-29-2-12 ~]$ sudo docker run -d --name broker -p 1883:1883 -p 80:80   harbor.vcloud.nii.ac.jp/sinetstream/android-tutorial:latest
[sudo] password for ec2-user:
5f183700ea81ffe2118fe5117f306bd9897ac27d28d5dce124ad391993db7782
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  ページトップへ戻る
</button>
        
      </main>
      
        <div class="site-footer-copyright">Copyright(C) National Institute of Informatics</div>
<div class="site-footer-logo">
  <a href="https://www.nii.ac.jp/">
    
    <img src="../../../images/NIIlogo_JP_ls.png" alt="NII 国立情報学研究所">
    
  </a>
</div>
<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.tabs", "navigation.tabs.sticky", "navigation.top"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>